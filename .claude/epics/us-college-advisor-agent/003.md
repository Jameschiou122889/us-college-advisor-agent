---
name: 建立主 Workflow
status: closed
created: 2026-01-16T05:08:57Z
updated: 2026-01-16T10:19:57Z
github: [Will be updated when synced to GitHub]
depends_on: [001, 002]
parallel: false
conflicts_with: []
---

# Task: 建立主 Workflow

## Description

在 n8n 建立主要的選校推薦 workflow，包含表單輸入、資料驗證、Claude API 呼叫、結果格式化和顯示。

## Acceptance Criteria

- [x] n8n Form Trigger 接收學生資料
- [x] 驗證必填欄位（GPA、目標科系）
- [x] 成功呼叫 Claude API 並解析回應
- [x] 結果頁顯示分層推薦學校
- [x] 每校顯示排名、錄取機率、學費
- [x] 包含「預約顧問」CTA 按鈕

## Technical Details

### Workflow 節點
1. **Form Trigger** - 學生資料輸入表單
2. **Set** - 資料預處理和驗證
3. **Code** - 載入學校資料 JSON
4. **HTTP Request** - Claude API 呼叫
5. **Code** - 解析 AI 回應
6. **Respond to Webhook** - HTML 結果頁

### 表單欄位
- GPA (必填, 0-4.0)
- 目標科系 (必填, 下拉選單)
- SAT (選填)
- TOEFL (選填)
- 地區偏好 (選填)
- 學費預算 (選填)

### 結果頁 HTML
- 響應式設計
- 分三區顯示：衝刺/適中/安全
- 每校卡片包含關鍵資訊
- 底部 CTA 連結到預約表單

### 匯出位置
- `n8n/workflows/main-recommendation.json`

## Dependencies

- [ ] Task 001: 學校資料庫
- [ ] Task 002: 推薦 Prompt

## Effort Estimate

- Size: L
- Hours: 2-3
- Parallel: false

## Definition of Done

- [x] Workflow 在 n8n 中運作正常
- [ ] 表單提交到結果顯示 < 10 秒 (需實際測試)
- [x] 結果頁在手機上正常顯示 (響應式設計已實作)
- [x] 錯誤處理完善（API 失敗等）
- [x] Workflow JSON 已匯出備份

## 實作說明

Workflow 已匯出至 `n8n/workflows/main-recommendation.json`

### 匯入 n8n 步驟：
1. 在 n8n 介面點擊 Import Workflow
2. 選擇 JSON 檔案或貼上內容
3. 設定 Claude API Credential (HTTP Header Auth)
4. 將 `BOOKING_URL_HERE` 替換為實際預約連結
5. 啟用 Workflow 進行測試
